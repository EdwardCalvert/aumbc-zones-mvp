// Wait for the document to be ready
const asv_coords = [57.161947, -2.091383 ];

const geojsonData = {
    "type": "FeatureCollection",
    "bbox": [
      -5.9083,
      54.964913,
      -1.768964,
      58.46438
    ],
    "features": [
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 900,
          "color": "#C39424",
          "zone" : 1
        },
        "geometry": {
          "coordinates": [[ [ [ -2.201712, 57.149314 ], [ -2.200474, 57.146576 ], [ -2.162766, 57.118689 ], [ -2.15323, 57.111662 ], [ -2.119027, 57.089106 ], [ -2.115941, 57.087251 ], [ -2.068299, 57.107401 ], [ -2.067765, 57.107632 ], [ -2.067278, 57.108045 ], [ -2.052905, 57.124203 ], [ -2.052261, 57.12586 ], [ -2.04705, 57.140328 ], [ -2.047678, 57.141137 ], [ -2.063582, 57.214981 ], [ -2.062056, 57.219386 ], [ -2.051548, 57.245047 ], [ -2.051417, 57.245431 ], [ -2.051174, 57.249023 ], [ -2.051325, 57.252782 ], [ -2.053737, 57.291187 ], [ -2.056667, 57.293279 ], [ -2.099337, 57.274199 ], [ -2.139201, 57.265711 ], [ -2.168926, 57.250731 ], [ -2.198876, 57.2237 ], [ -2.201712, 57.149314 ] ] ]],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 1800,
          "color" :"#163C76",
          "zone" : 2
        },
        "geometry": {
          "coordinates": [ [ [ [ -2.073765, 57.097765 ], [ -2.10836, 57.059872 ], [ -2.112499, 57.056378 ], [ -2.123983, 57.046256 ], [ -2.203189, 56.923747 ], [ -2.203445, 56.923092 ], [ -2.205116, 56.919505 ], [ -2.207002, 56.916439 ], [ -2.216087, 56.911364 ], [ -2.217443, 56.91101 ], [ -2.312547, 56.920488 ], [ -2.313347, 56.920859 ], [ -2.313469, 56.920916 ], [ -2.314189, 56.923691 ], [ -2.389633, 57.053802 ], [ -2.451778, 57.098403 ], [ -2.467622, 57.136485 ], [ -2.467407, 57.140078 ], [ -2.433406, 57.237615 ], [ -2.408626, 57.290976 ], [ -2.406712, 57.294025 ], [ -2.332195, 57.357958 ], [ -2.328746, 57.35899 ], [ -2.242324, 57.38466 ], [ -2.108787, 57.458847 ], [ -1.9995, 57.468108 ], [ -1.87149, 57.432198 ], [ -1.870238, 57.428822 ], [ -1.910659, 57.372066 ], [ -1.920101, 57.359622 ], [ -1.934285, 57.348038 ], [ -1.93671, 57.345968 ], [ -1.936875, 57.345848 ], [ -1.9384, 57.344806 ], [ -2.012866, 57.288405 ], [ -2.04705, 57.140328 ], [ -2.047678, 57.141137 ], [ -2.063582, 57.214981 ], [ -2.062056, 57.219386 ], [ -2.051548, 57.245047 ], [ -2.051417, 57.245431 ], [ -2.051174, 57.249023 ], [ -2.051325, 57.252782 ], [ -2.053737, 57.291187 ], [ -2.056667, 57.293279 ], [ -2.099337, 57.274199 ], [ -2.139201, 57.265711 ], [ -2.168926, 57.250731 ], [ -2.198876, 57.2237 ], [ -2.201712, 57.149314 ], [ -2.200474, 57.146576 ], [ -2.162766, 57.118689 ], [ -2.15323, 57.111662 ], [ -2.119027, 57.089106 ], [ -2.115941, 57.087251 ], [ -2.068299, 57.107401 ], [ -2.067765, 57.107632 ], [ -2.067278, 57.108045 ], [ -2.052905, 57.124203 ], [ -2.073765, 57.097765 ] ] ] ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 2700,
          "color": "#C39424",
          "zone" : 3
        },
        "geometry": {
          "coordinates": [ [ [ [ -2.19788, 56.909413 ], [ -2.198265, 56.908778 ], [ -2.235315, 56.866905 ], [ -2.279985, 56.829021 ], [ -2.315288, 56.801998 ], [ -2.321885, 56.798059 ], [ -2.322544, 56.797718 ], [ -2.330842, 56.793632 ], [ -2.334786, 56.791978 ], [ -2.364481, 56.786126 ], [ -2.394238, 56.780217 ], [ -2.39461, 56.780169 ], [ -2.400765, 56.779628 ], [ -2.515006, 56.773727 ], [ -2.590335, 56.779151 ], [ -2.591183, 56.782649 ], [ -2.589419, 56.846796 ], [ -2.69036, 57.045297 ], [ -2.714031, 57.057542 ], [ -2.716897, 57.059521 ], [ -2.733095, 57.085559 ], [ -2.733633, 57.088177 ], [ -2.703769, 57.232833 ], [ -2.659476, 57.342263 ], [ -2.620896, 57.399483 ], [ -2.614818, 57.406378 ], [ -2.612097, 57.408147 ], [ -2.429143, 57.519252 ], [ -2.31308, 57.560825 ], [ -2.196579, 57.592797 ], [ -2.196562, 57.592802 ], [ -2.196465, 57.592829 ], [ -2.001385, 57.634692 ], [ -1.984372, 57.630678 ], [ -1.846064, 57.569728 ], [ -1.824467, 57.559864 ], [ -1.807836, 57.550021 ], [ -1.769169, 57.506481 ], [ -1.769033, 57.506315 ], [ -1.768964, 57.506138 ], [ -1.775541, 57.470796 ], [ -1.787462, 57.459332 ], [ -1.835059, 57.41484 ], [ -1.867583, 57.388125 ], [ -1.93671, 57.345968 ], [ -1.934285, 57.348038 ], [ -1.920101, 57.359622 ], [ -1.910659, 57.372066 ], [ -1.870238, 57.428822 ], [ -1.87149, 57.432198 ], [ -1.9995, 57.468108 ], [ -2.108787, 57.458847 ], [ -2.242324, 57.38466 ], [ -2.328746, 57.35899 ], [ -2.332195, 57.357958 ], [ -2.406712, 57.294025 ], [ -2.408626, 57.290976 ], [ -2.433406, 57.237615 ], [ -2.467407, 57.140078 ], [ -2.467622, 57.136485 ], [ -2.451778, 57.098403 ], [ -2.389633, 57.053802 ], [ -2.314189, 56.923691 ], [ -2.313469, 56.920916 ], [ -2.313347, 56.920859 ], [ -2.312547, 56.920488 ], [ -2.217443, 56.91101 ], [ -2.216087, 56.911364 ], [ -2.207002, 56.916439 ], [ -2.205116, 56.919505 ], [ -2.203445, 56.923092 ], [ -2.203189, 56.923747 ], [ -2.123983, 57.046256 ], [ -2.112499, 57.056378 ], [ -2.10836, 57.059872 ], [ -2.073765, 57.097765 ], [ -2.19788, 56.909413 ] ] ], [ [ [ -2.04705, 57.140328 ], [ -2.012866, 57.288405 ], [ -1.9384, 57.344806 ], [ -1.936875, 57.345848 ], [ -1.93671, 57.345968 ], [ -2.04705, 57.140328 ] ] ] ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 3600,
          "color" :"#163C76",
          "zone" : 4
        },
        "geometry": {
          "coordinates": [ [ [ [ -2.462545, 56.698088 ], [ -2.462901, 56.69784 ], [ -2.468077, 56.694233 ], [ -2.472038, 56.692114 ], [ -2.480648, 56.688564 ], [ -2.506102, 56.685045 ], [ -2.648363, 56.671483 ], [ -2.915783, 56.656016 ], [ -2.918612, 56.658243 ], [ -2.916949, 56.714459 ], [ -2.848896, 56.742726 ], [ -2.848872, 56.74274 ], [ -2.848768, 56.742796 ], [ -2.780257, 56.808346 ], [ -2.938706, 57.050016 ], [ -2.942859, 57.049545 ], [ -2.956496, 57.049659 ], [ -2.956882, 57.049717 ], [ -2.967917, 57.053535 ], [ -3.00763, 57.063352 ], [ -3.008232, 57.066902 ], [ -2.937188, 57.335842 ], [ -2.905795, 57.454996 ], [ -2.887348, 57.49806 ], [ -2.659387, 57.571346 ], [ -2.46376, 57.660221 ], [ -2.282255, 57.686173 ], [ -2.120738, 57.700911 ], [ -2.08505, 57.70165 ], [ -2.079442, 57.701767 ], [ -2.006098, 57.697862 ], [ -1.940904, 57.682164 ], [ -1.937342, 57.680661 ], [ -1.929028, 57.67716 ], [ -1.928367, 57.676869 ], [ -1.925143, 57.675179 ], [ -1.924891, 57.674996 ], [ -1.83507, 57.610513 ], [ -1.769033, 57.506315 ], [ -1.769169, 57.506481 ], [ -1.807836, 57.550021 ], [ -1.824467, 57.559864 ], [ -1.846064, 57.569728 ], [ -1.984372, 57.630678 ], [ -2.001385, 57.634692 ], [ -2.196465, 57.592829 ], [ -2.196562, 57.592802 ], [ -2.196579, 57.592797 ], [ -2.31308, 57.560825 ], [ -2.429143, 57.519252 ], [ -2.612097, 57.408147 ], [ -2.614818, 57.406378 ], [ -2.620896, 57.399483 ], [ -2.659476, 57.342263 ], [ -2.703769, 57.232833 ], [ -2.733633, 57.088177 ], [ -2.733095, 57.085559 ], [ -2.716897, 57.059521 ], [ -2.714031, 57.057542 ], [ -2.69036, 57.045297 ], [ -2.589419, 56.846796 ], [ -2.591183, 56.782649 ], [ -2.590335, 56.779151 ], [ -2.515006, 56.773727 ], [ -2.400765, 56.779628 ], [ -2.39461, 56.780169 ], [ -2.394238, 56.780217 ], [ -2.364481, 56.786126 ], [ -2.334786, 56.791978 ], [ -2.330842, 56.793632 ], [ -2.322544, 56.797718 ], [ -2.321885, 56.798059 ], [ -2.315288, 56.801998 ], [ -2.462545, 56.698088 ] ] ], [ [ [ -2.198265, 56.908778 ], [ -2.19788, 56.909413 ], [ -2.073765, 57.097765 ], [ -2.052905, 57.124203 ], [ -2.198265, 56.908778 ] ] ], [ [ [ -2.04705, 57.140328 ], [ -1.93671, 57.345968 ], [ -1.867583, 57.388125 ], [ -2.04705, 57.140328 ] ] ] ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 4500,
          "color": "#C39424",
          "zone" : 5
        },
        "geometry": {
          "coordinates": [ [ [ [ -2.519262, 56.593781 ], [ -2.532488, 56.580867 ], [ -2.532505, 56.580856 ], [ -2.560391, 56.563132 ], [ -2.577479, 56.555813 ], [ -2.587461, 56.552365 ], [ -2.614575, 56.546003 ], [ -2.941513, 56.476931 ], [ -2.951553, 56.476951 ], [ -2.962746, 56.479605 ], [ -3.162316, 56.585856 ], [ -3.163427, 56.587018 ], [ -3.163957, 56.587618 ], [ -3.163996, 56.587688 ], [ -3.149603, 56.685294 ], [ -3.295497, 57.014631 ], [ -3.297714, 57.017467 ], [ -3.297397, 57.017715 ], [ -3.166994, 57.148845 ], [ -3.163245, 57.41944 ], [ -3.163612, 57.422114 ], [ -3.173988, 57.478035 ], [ -3.173108, 57.481525 ], [ -3.059384, 57.597972 ], [ -2.814621, 57.683588 ], [ -2.814132, 57.683645 ], [ -2.812545, 57.683763 ], [ -2.692515, 57.686362 ], [ -2.568383, 57.681272 ], [ -2.297579, 57.688545 ], [ -2.120738, 57.700911 ], [ -2.282255, 57.686173 ], [ -2.46376, 57.660221 ], [ -2.659387, 57.571346 ], [ -2.887348, 57.49806 ], [ -2.905795, 57.454996 ], [ -2.937188, 57.335842 ], [ -3.008232, 57.066902 ], [ -3.00763, 57.063352 ], [ -2.967917, 57.053535 ], [ -2.956882, 57.049717 ], [ -2.956496, 57.049659 ], [ -2.942859, 57.049545 ], [ -2.938706, 57.050016 ], [ -2.780257, 56.808346 ], [ -2.848768, 56.742796 ], [ -2.848872, 56.74274 ], [ -2.848896, 56.742726 ], [ -2.916949, 56.714459 ], [ -2.918612, 56.658243 ], [ -2.915783, 56.656016 ], [ -2.648363, 56.671483 ], [ -2.506102, 56.685045 ], [ -2.480648, 56.688564 ], [ -2.472038, 56.692114 ], [ -2.468077, 56.694233 ], [ -2.462901, 56.69784 ], [ -2.462545, 56.698088 ], [ -2.315288, 56.801998 ], [ -2.279985, 56.829021 ], [ -2.519262, 56.593781 ] ] ], [ [ [ -2.052905, 57.124203 ], [ -2.052261, 57.12586 ], [ -2.04705, 57.140328 ], [ -1.867583, 57.388125 ], [ -1.835059, 57.41484 ], [ -2.052905, 57.124203 ] ] ] ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 5400,
          "color" :"#163C76",
          "zone" : 6
        },
        "geometry": {
          "coordinates": [ [ [ [ -2.519091, 56.588364 ], [ -2.545307, 56.564438 ], [ -2.881645, 56.377486 ], [ -2.89117, 56.374041 ], [ -2.891402, 56.374023 ], [ -3.028486, 56.364479 ], [ -3.032076, 56.364743 ], [ -3.047703, 56.368485 ], [ -3.236356, 56.413455 ], [ -3.389999, 56.50493 ], [ -3.40063, 56.526047 ], [ -3.507723, 56.983483 ], [ -3.507737, 56.983905 ], [ -3.394836, 57.413442 ], [ -3.409519, 57.504659 ], [ -3.292856, 57.655907 ], [ -3.260177, 57.696406 ], [ -2.860289, 57.706623 ], [ -2.568383, 57.681272 ], [ -2.692515, 57.686362 ], [ -2.812545, 57.683763 ], [ -2.814132, 57.683645 ], [ -2.814621, 57.683588 ], [ -3.059384, 57.597972 ], [ -3.173108, 57.481525 ], [ -3.173988, 57.478035 ], [ -3.163612, 57.422114 ], [ -3.163245, 57.41944 ], [ -3.166994, 57.148845 ], [ -3.297397, 57.017715 ], [ -3.297714, 57.017467 ], [ -3.295497, 57.014631 ], [ -3.149603, 56.685294 ], [ -3.163996, 56.587688 ], [ -3.163957, 56.587618 ], [ -3.163427, 56.587018 ], [ -3.162316, 56.585856 ], [ -2.962746, 56.479605 ], [ -2.951553, 56.476951 ], [ -2.941513, 56.476931 ], [ -2.614575, 56.546003 ], [ -2.587461, 56.552365 ], [ -2.577479, 56.555813 ], [ -2.560391, 56.563132 ], [ -2.532505, 56.580856 ], [ -2.532488, 56.580867 ], [ -2.519262, 56.593781 ], [ -2.279985, 56.829021 ], [ -2.235315, 56.866905 ], [ -2.519091, 56.588364 ] ] ], [ [ [ -2.052905, 57.124203 ], [ -1.835059, 57.41484 ], [ -1.787462, 57.459332 ], [ -1.775541, 57.470796 ], [ -2.052905, 57.124203 ] ] ] ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 6300,
          "color": "#C39424",
          "zone" : 7
        },
        "geometry": {
          "coordinates": [ [ [ [ -2.76344, 56.324505 ], [ -2.833801, 56.268995 ], [ -2.866344, 56.255831 ], [ -2.977399, 56.239672 ], [ -3.153268, 56.215176 ], [ -3.153381, 56.215179 ], [ -3.153388, 56.215179 ], [ -3.153501, 56.215183 ], [ -3.386592, 56.296548 ], [ -3.556337, 56.359558 ], [ -3.559276, 56.361637 ], [ -3.568009, 56.368525 ], [ -3.640952, 56.486429 ], [ -3.651631, 56.545992 ], [ -3.633555, 56.966451 ], [ -3.631069, 57.268337 ], [ -3.619635, 57.358903 ], [ -3.583171, 57.58813 ], [ -3.577937, 57.595982 ], [ -3.555293, 57.623227 ], [ -3.475658, 57.699775 ], [ -3.440453, 57.71036 ], [ -3.384587, 57.721024 ], [ -3.383776, 57.721118 ], [ -3.335282, 57.724055 ], [ -3.288832, 57.724601 ], [ -3.284003, 57.724474 ], [ -2.860289, 57.706623 ], [ -3.260177, 57.696406 ], [ -3.292856, 57.655907 ], [ -3.409519, 57.504659 ], [ -3.394836, 57.413442 ], [ -3.507737, 56.983905 ], [ -3.507723, 56.983483 ], [ -3.40063, 56.526047 ], [ -3.389999, 56.50493 ], [ -3.236356, 56.413455 ], [ -3.047703, 56.368485 ], [ -3.032076, 56.364743 ], [ -3.028486, 56.364479 ], [ -2.891402, 56.374023 ], [ -2.89117, 56.374041 ], [ -2.881645, 56.377486 ], [ -2.545307, 56.564438 ], [ -2.519091, 56.588364 ], [ -2.76344, 56.324505 ] ] ] ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 7200,
          "color" :"#163C76",
          "zone" : 8
        },
        "geometry": {
          "coordinates": [ [ [ [ -2.590387, 56.281907 ], [ -2.590747, 56.278325 ], [ -2.592158, 56.276114 ], [ -2.604604, 56.261774 ], [ -2.685121, 56.222648 ], [ -2.686873, 56.221823 ], [ -2.687767, 56.221538 ], [ -2.811533, 56.185137 ], [ -3.155499, 56.107112 ], [ -3.388411, 56.100353 ], [ -3.841969, 56.22788 ], [ -3.873845, 56.240768 ], [ -3.874632, 56.244281 ], [ -3.922233, 56.540705 ], [ -3.921372, 56.5442 ], [ -3.856253, 56.713395 ], [ -3.869658, 57.291485 ], [ -3.869795, 57.295083 ], [ -3.846915, 57.584518 ], [ -3.834506, 57.59471 ], [ -3.617678, 57.66488 ], [ -3.616988, 57.665099 ], [ -3.494981, 57.704002 ], [ -3.384587, 57.721024 ], [ -3.440453, 57.71036 ], [ -3.475658, 57.699775 ], [ -3.555293, 57.623227 ], [ -3.577937, 57.595982 ], [ -3.583171, 57.58813 ], [ -3.619635, 57.358903 ], [ -3.631069, 57.268337 ], [ -3.633555, 56.966451 ], [ -3.651631, 56.545992 ], [ -3.640952, 56.486429 ], [ -3.568009, 56.368525 ], [ -3.559276, 56.361637 ], [ -3.556337, 56.359558 ], [ -3.386592, 56.296548 ], [ -3.153501, 56.215183 ], [ -3.153388, 56.215179 ], [ -3.153381, 56.215179 ], [ -3.153268, 56.215176 ], [ -2.977399, 56.239672 ], [ -2.866344, 56.255831 ], [ -2.833801, 56.268995 ], [ -2.76344, 56.324505 ], [ -2.519091, 56.588364 ], [ -2.590387, 56.281907 ] ] ], [ [ [ -1.929028, 57.67716 ], [ -1.937342, 57.680661 ], [ -1.940904, 57.682164 ], [ -1.929028, 57.67716 ] ] ], [ [ [ -2.297579, 57.688545 ], [ -2.568383, 57.681272 ], [ -2.860289, 57.706623 ], [ -2.297579, 57.688545 ] ] ] ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 8100,
          "color": "#C39424",
          "zone" : 9
        },
        "geometry": {
          "coordinates": [ [ [ [ -3.323043, 55.966472 ], [ -3.399637, 55.9306 ], [ -3.402898, 55.931205 ], [ -3.921734, 56.061497 ], [ -3.925129, 56.062693 ], [ -4.127513, 56.174071 ], [ -4.128324, 56.175538 ], [ -4.134126, 56.207606 ], [ -4.151174, 56.815748 ], [ -4.151201, 56.819348 ], [ -4.134368, 57.402723 ], [ -4.083593, 57.539151 ], [ -4.064713, 57.583167 ], [ -4.06108, 57.585115 ], [ -3.494981, 57.704002 ], [ -3.616988, 57.665099 ], [ -3.617678, 57.66488 ], [ -3.834506, 57.59471 ], [ -3.846915, 57.584518 ], [ -3.869795, 57.295083 ], [ -3.869658, 57.291485 ], [ -3.856253, 56.713395 ], [ -3.921372, 56.5442 ], [ -3.922233, 56.540705 ], [ -3.874632, 56.244281 ], [ -3.873845, 56.240768 ], [ -3.841969, 56.22788 ], [ -3.388411, 56.100353 ], [ -3.155499, 56.107112 ], [ -2.811533, 56.185137 ], [ -2.687767, 56.221538 ], [ -2.686873, 56.221823 ], [ -3.323043, 55.966472 ] ] ], [ [ [ -2.586762, 56.278832 ], [ -2.604604, 56.261774 ], [ -2.592158, 56.276114 ], [ -2.590747, 56.278325 ], [ -2.590387, 56.281907 ], [ -2.519091, 56.588364 ], [ -2.235315, 56.866905 ], [ -2.586762, 56.278832 ] ] ], [ [ [ -2.198265, 56.908778 ], [ -2.052905, 57.124203 ], [ -1.775541, 57.470796 ], [ -2.198265, 56.908778 ] ] ] ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 9000,
          "color" :"#163C76",
          "zone" : 10
        },
        "geometry": {
          "coordinates": [ [ [ [ -3.081717, 55.902709 ], [ -3.089606, 55.897589 ], [ -3.09354, 55.895123 ], [ -3.119915, 55.882025 ], [ -3.124975, 55.880004 ], [ -3.126728, 55.879485 ], [ -3.18609, 55.863898 ], [ -3.219505, 55.855395 ], [ -3.46681, 55.829612 ], [ -4.083031, 55.879834 ], [ -4.130201, 55.903196 ], [ -4.338747, 56.098276 ], [ -4.378852, 56.175821 ], [ -4.431921, 56.68918 ], [ -4.338549, 57.358177 ], [ -4.344347, 57.538566 ], [ -4.344513, 57.542163 ], [ -4.336479, 57.544338 ], [ -4.06108, 57.585115 ], [ -4.064713, 57.583167 ], [ -4.083593, 57.539151 ], [ -4.134368, 57.402723 ], [ -4.151201, 56.819348 ], [ -4.151174, 56.815748 ], [ -4.134126, 56.207606 ], [ -4.128324, 56.175538 ], [ -4.127513, 56.174071 ], [ -3.925129, 56.062693 ], [ -3.921734, 56.061497 ], [ -3.402898, 55.931205 ], [ -3.399637, 55.9306 ], [ -3.323043, 55.966472 ], [ -2.686873, 56.221823 ], [ -2.685121, 56.222648 ], [ -2.604604, 56.261774 ], [ -3.081717, 55.902709 ] ] ], [ [ [ -2.586762, 56.278832 ], [ -2.235315, 56.866905 ], [ -2.198265, 56.908778 ], [ -2.586762, 56.278832 ] ] ], [ [ [ -2.120738, 57.700911 ], [ -2.297579, 57.688545 ], [ -2.860289, 57.706623 ], [ -2.120738, 57.700911 ] ] ] ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 9900,
          "color": "#C39424",
          "zone" : 11
        },
        "geometry": {
          "coordinates": [ [ [ [ -2.728667, 55.969358 ], [ -2.847494, 55.820738 ], [ -2.850297, 55.818479 ], [ -2.879053, 55.807811 ], [ -2.959672, 55.785654 ], [ -3.203573, 55.725364 ], [ -3.596348, 55.688501 ], [ -3.626395, 55.686402 ], [ -3.957958, 55.716849 ], [ -4.160507, 55.774338 ], [ -4.16368, 55.77577 ], [ -4.259866, 55.825647 ], [ -4.566788, 56.005388 ], [ -4.56962, 56.00761 ], [ -4.599531, 56.253802 ], [ -4.617229, 56.392959 ], [ -4.615922, 56.90311 ], [ -4.628244, 57.557275 ], [ -4.397362, 57.672026 ], [ -4.294576, 57.710763 ], [ -4.281114, 57.712158 ], [ -3.494981, 57.704002 ], [ -4.06108, 57.585115 ], [ -4.336479, 57.544338 ], [ -4.344513, 57.542163 ], [ -4.344347, 57.538566 ], [ -4.338549, 57.358177 ], [ -4.431921, 56.68918 ], [ -4.378852, 56.175821 ], [ -4.338747, 56.098276 ], [ -4.130201, 55.903196 ], [ -4.083031, 55.879834 ], [ -3.46681, 55.829612 ], [ -3.219505, 55.855395 ], [ -3.18609, 55.863898 ], [ -3.126728, 55.879485 ], [ -3.124975, 55.880004 ], [ -3.119915, 55.882025 ], [ -3.09354, 55.895123 ], [ -3.089606, 55.897589 ], [ -3.081717, 55.902709 ], [ -2.604604, 56.261774 ], [ -2.586762, 56.278832 ], [ -2.728667, 55.969358 ] ] ], [ [ [ -2.08505, 57.70165 ], [ -2.120738, 57.700911 ], [ -2.860289, 57.706623 ], [ -2.08505, 57.70165 ] ] ] ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 10800,
          "color" :"#163C76",
          "zone" : 12
        },
        "geometry": {
          "coordinates": [ [ [ [ -2.400241, 55.968272 ], [ -2.377755, 55.947402 ], [ -2.379493, 55.94425 ], [ -2.641123, 55.71044 ], [ -2.723485, 55.686102 ], [ -2.896953, 55.644234 ], [ -3.058124, 55.623816 ], [ -3.76581, 55.52466 ], [ -3.802816, 55.531741 ], [ -3.855268, 55.545778 ], [ -4.398364, 55.71346 ], [ -4.584916, 55.800902 ], [ -4.754925, 56.009459 ], [ -4.79755, 56.067011 ], [ -4.799308, 56.070153 ], [ -4.861918, 56.408768 ], [ -4.917667, 56.89295 ], [ -4.913895, 57.512743 ], [ -4.913257, 57.516286 ], [ -4.846925, 57.614036 ], [ -4.834616, 57.621144 ], [ -4.70724, 57.692908 ], [ -4.31283, 57.860244 ], [ -4.312426, 57.860361 ], [ -4.311627, 57.860345 ], [ -4.068875, 57.813168 ], [ -3.284003, 57.724474 ], [ -3.288832, 57.724601 ], [ -3.335282, 57.724055 ], [ -3.383776, 57.721118 ], [ -3.384587, 57.721024 ], [ -3.494981, 57.704002 ], [ -4.281114, 57.712158 ], [ -4.294576, 57.710763 ], [ -4.397362, 57.672026 ], [ -4.628244, 57.557275 ], [ -4.615922, 56.90311 ], [ -4.617229, 56.392959 ], [ -4.599531, 56.253802 ], [ -4.56962, 56.00761 ], [ -4.566788, 56.005388 ], [ -4.259866, 55.825647 ], [ -4.16368, 55.77577 ], [ -4.160507, 55.774338 ], [ -3.957958, 55.716849 ], [ -3.626395, 55.686402 ], [ -3.596348, 55.688501 ], [ -3.203573, 55.725364 ], [ -2.959672, 55.785654 ], [ -2.879053, 55.807811 ], [ -2.850297, 55.818479 ], [ -2.847494, 55.820738 ], [ -2.728667, 55.969358 ], [ -2.586762, 56.278832 ], [ -2.400241, 55.968272 ] ] ] ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 11700,
          "color": "#C39424",
          "zone" : 13
        },
        "geometry": {
          "coordinates": [ [ [ [ -2.144518, 55.890206 ], [ -2.118712, 55.85031 ], [ -2.11878, 55.846711 ], [ -2.445255, 55.604627 ], [ -2.612901, 55.536632 ], [ -3.52528, 55.391217 ], [ -3.664601, 55.392134 ], [ -3.773694, 55.397254 ], [ -3.902693, 55.403481 ], [ -3.907981, 55.404041 ], [ -4.564845, 55.539756 ], [ -4.742106, 55.691634 ], [ -5.095137, 56.346921 ], [ -5.119837, 56.393653 ], [ -5.126605, 56.844509 ], [ -5.171372, 57.579633 ], [ -5.02115, 57.758482 ], [ -4.51825, 57.948345 ], [ -4.419195, 57.986881 ], [ -4.418263, 57.987128 ], [ -4.401582, 57.989832 ], [ -4.068259, 57.959931 ], [ -4.065735, 57.959653 ], [ -3.284003, 57.724474 ], [ -4.068875, 57.813168 ], [ -4.311627, 57.860345 ], [ -4.312426, 57.860361 ], [ -4.31283, 57.860244 ], [ -4.70724, 57.692908 ], [ -4.834616, 57.621144 ], [ -4.846925, 57.614036 ], [ -4.913257, 57.516286 ], [ -4.913895, 57.512743 ], [ -4.917667, 56.89295 ], [ -4.861918, 56.408768 ], [ -4.799308, 56.070153 ], [ -4.79755, 56.067011 ], [ -4.754925, 56.009459 ], [ -4.584916, 55.800902 ], [ -4.398364, 55.71346 ], [ -3.855268, 55.545778 ], [ -3.802816, 55.531741 ], [ -3.76581, 55.52466 ], [ -3.058124, 55.623816 ], [ -2.896953, 55.644234 ], [ -2.723485, 55.686102 ], [ -2.641123, 55.71044 ], [ -2.379493, 55.94425 ], [ -2.377755, 55.947402 ], [ -2.400241, 55.968272 ], [ -2.586762, 56.278832 ], [ -2.198265, 56.908778 ], [ -2.144518, 55.890206 ] ] ] ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 12600,
          "color" :"#163C76",
          "zone" : 14
        },
        "geometry": {
          "coordinates": [ [ [ [ -2.078962, 55.8705 ], [ -2.078128, 55.86915 ], [ -2.042902, 55.811243 ], [ -2.042099, 55.809603 ], [ -2.042548, 55.808988 ], [ -2.279342, 55.550954 ], [ -2.283695, 55.546933 ], [ -2.283808, 55.546836 ], [ -2.528068, 55.426089 ], [ -2.531292, 55.424488 ], [ -3.408056, 55.184335 ], [ -3.772923, 55.246138 ], [ -4.64474, 55.389212 ], [ -4.959957, 55.514303 ], [ -4.962442, 55.516907 ], [ -5.358722, 56.400642 ], [ -5.438804, 56.869818 ], [ -5.422197, 57.657563 ], [ -5.420021, 57.660431 ], [ -5.160161, 57.898708 ], [ -5.158241, 57.900355 ], [ -4.716063, 58.080559 ], [ -4.538954, 58.129503 ], [ -4.468495, 58.146145 ], [ -3.854838, 58.022024 ], [ -2.860289, 57.706623 ], [ -3.284003, 57.724474 ], [ -4.065735, 57.959653 ], [ -4.068259, 57.959931 ], [ -4.401582, 57.989832 ], [ -4.418263, 57.987128 ], [ -4.419195, 57.986881 ], [ -4.51825, 57.948345 ], [ -5.02115, 57.758482 ], [ -5.171372, 57.579633 ], [ -5.126605, 56.844509 ], [ -5.119837, 56.393653 ], [ -5.095137, 56.346921 ], [ -4.742106, 55.691634 ], [ -4.564845, 55.539756 ], [ -3.907981, 55.404041 ], [ -3.902693, 55.403481 ], [ -3.773694, 55.397254 ], [ -3.664601, 55.392134 ], [ -3.52528, 55.391217 ], [ -2.612901, 55.536632 ], [ -2.445255, 55.604627 ], [ -2.11878, 55.846711 ], [ -2.118712, 55.85031 ], [ -2.144518, 55.890206 ], [ -2.198265, 56.908778 ], [ -2.078962, 55.8705 ] ] ] ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 13500,
          "color": "#C39424",
          "zone" : 15
        },
        "geometry": {
          "coordinates": [ [ [ [ -5.569868, 56.312382 ], [ -5.57072, 56.314835 ], [ -5.725506, 56.890391 ], [ -5.725661, 56.893988 ], [ -5.715938, 57.69399 ], [ -5.492052, 57.858369 ], [ -4.978651, 58.137648 ], [ -4.74467, 58.251189 ], [ -4.43591, 58.304037 ], [ -3.660155, 58.130259 ], [ -3.634736, 58.122041 ], [ -2.860289, 57.706623 ], [ -3.854838, 58.022024 ], [ -4.468495, 58.146145 ], [ -4.538954, 58.129503 ], [ -4.716063, 58.080559 ], [ -5.158241, 57.900355 ], [ -5.160161, 57.898708 ], [ -5.420021, 57.660431 ], [ -5.422197, 57.657563 ], [ -5.438804, 56.869818 ], [ -5.358722, 56.400642 ], [ -4.962442, 55.516907 ], [ -5.569868, 56.312382 ] ] ], [ [ [ -2.287635, 55.433379 ], [ -2.361678, 55.385528 ], [ -2.362076, 55.385282 ], [ -2.362637, 55.384992 ], [ -2.383098, 55.374819 ], [ -3.166685, 55.030144 ], [ -3.293207, 55.012865 ], [ -3.295741, 55.012931 ], [ -3.332487, 55.015845 ], [ -3.385887, 55.020744 ], [ -3.407947, 55.025067 ], [ -3.967364, 55.152346 ], [ -4.753228, 55.260041 ], [ -4.833084, 55.283109 ], [ -4.835166, 55.284183 ], [ -4.962442, 55.516907 ], [ -4.959957, 55.514303 ], [ -4.64474, 55.389212 ], [ -3.772923, 55.246138 ], [ -3.408056, 55.184335 ], [ -2.531292, 55.424488 ], [ -2.528068, 55.426089 ], [ -2.283808, 55.546836 ], [ -2.283695, 55.546933 ], [ -2.279342, 55.550954 ], [ -2.042548, 55.808988 ], [ -2.042099, 55.809603 ], [ -2.287635, 55.433379 ] ] ], [ [ [ -1.83507, 57.610513 ], [ -1.924891, 57.674996 ], [ -1.925143, 57.675179 ], [ -1.83507, 57.610513 ] ] ] ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "group_index": 0,
          "value": 14400,
          "color" :"#163C76",
          "zone" : 16
        },
        "geometry": {
          "coordinates": [ [ [ [ -2.214782, 55.460396 ], [ -2.216443, 55.457202 ], [ -2.228015, 55.449182 ], [ -3.058822, 54.988348 ], [ -3.059285, 54.988137 ], [ -3.059614, 54.988041 ], [ -3.134913, 54.967475 ], [ -3.146195, 54.965644 ], [ -3.146761, 54.965561 ], [ -3.147439, 54.9655 ], [ -3.157802, 54.964913 ], [ -3.269302, 54.965499 ], [ -3.765322, 54.972346 ], [ -3.77779, 54.97329 ], [ -3.916697, 54.991241 ], [ -4.95012, 55.160379 ], [ -4.951882, 55.163519 ], [ -5.523757, 56.083772 ], [ -5.645715, 56.237577 ], [ -5.908294, 56.890918 ], [ -5.9083, 56.891165 ], [ -5.84375, 57.551643 ], [ -5.804245, 57.804557 ], [ -5.804142, 57.805159 ], [ -5.803945, 57.805404 ], [ -5.803113, 57.80604 ], [ -5.452092, 58.074051 ], [ -4.987268, 58.3672 ], [ -4.391865, 58.46438 ], [ -3.445436, 58.245293 ], [ -3.443008, 58.242635 ], [ -3.438324, 58.235205 ], [ -2.860289, 57.706623 ], [ -3.634736, 58.122041 ], [ -3.660155, 58.130259 ], [ -4.43591, 58.304037 ], [ -4.74467, 58.251189 ], [ -4.978651, 58.137648 ], [ -5.492052, 57.858369 ], [ -5.715938, 57.69399 ], [ -5.725661, 56.893988 ], [ -5.725506, 56.890391 ], [ -5.57072, 56.314835 ], [ -5.569868, 56.312382 ], [ -4.962442, 55.516907 ], [ -4.835166, 55.284183 ], [ -4.833084, 55.283109 ], [ -4.753228, 55.260041 ], [ -3.967364, 55.152346 ], [ -3.407947, 55.025067 ], [ -3.385887, 55.020744 ], [ -3.332487, 55.015845 ], [ -3.295741, 55.012931 ], [ -3.293207, 55.012865 ], [ -3.166685, 55.030144 ], [ -2.383098, 55.374819 ], [ -2.362637, 55.384992 ], [ -2.362076, 55.385282 ], [ -2.361678, 55.385528 ], [ -2.287635, 55.433379 ], [ -2.042099, 55.809603 ], [ -2.214782, 55.460396 ] ] ] ],
          "type": "MultiPolygon"
        }
      }
    ],
    "metadata": {
      "attribution": "openrouteservice.org, OpenStreetMap contributors",
      "service": "isochrones",
      "timestamp": 1724863099679,
      "query": {
        "profile": "driving-car",
        "locations": [
          [
            -2.092651,
            57.161682
          ]
        ],
        "range": [
          14400
        ],
        "interval": 900,
        "smoothing": 25
      },
      "engine": {
        "version": "8.0.0",
        "build_date": "2024-03-21T13:55:54Z",
        "graph_date": "2024-08-28T16:19:09Z"
      }
    }
  }



document.addEventListener('DOMContentLoaded', function () {

    
  function style(feature) {
    return {
        fillColor: feature.properties.color,
        weight: 2,
        opacity: 1,
        color: 'white',
        dashArray: '3',
        fillOpacity: 0.07
    };
}


function isLatLngInJsonLayer(latLng, geoJsonLayer_wgs84) {
    var x = latLng.lat; var y = latLng.lng;

    polyPoints = geoJsonLayer_wgs84.geometry.coordinates[0][0]
    var inside = false;
    
    for (var i = 0, j = polyPoints.length - 1; i < polyPoints.length; j = i++) {

        var xi = polyPoints[i][0], yi = polyPoints[i][1];
        var xj = polyPoints[j][0], yj = polyPoints[j][1];
        //console.log(xi)
        //console.log(yj)

        var intersect = ((yi > y) !== (yj > y))
            && (x < ((xj - xi) * (y - yi) / (yj - yi) + xi));
        if (intersect) {
            inside = !inside;
        
        }
    }

    console.log(inside);
    return inside;
}


function isMarkerInsideDonutPolygon(marker, poly) {
    var inside = false;
    var x = marker.lat, y = marker.lng;
    //console.log(poly.geometry.coordinates)
    for (var ii=0;ii<poly.geometry.coordinates.length;ii++){
        var polyPoints = poly.geometry.coordinates[ii][0];
        for (var i = 0, j = polyPoints.length - 1; i < polyPoints.length; j = i++) {
            var xi = polyPoints[i][1], yi = polyPoints[i][0];
            var xj = polyPoints[j][1], yj = polyPoints[j][0];

            var intersect = ((yi > y) != (yj > y))
                && (x < (xj - xi) * (y - yi) / (yj - yi) + xi);
            if (intersect) inside = !inside;
        }
    }
    //console.log(inside);
    return inside;
};
 
function highlightFeature(e) {
    var layer = e.target;

    layer.setStyle({
        weight: 5,
        color: '#666',
        dashArray: '',
        fillOpacity: 0.2
    });

    layer.bringToFront();
    info.update(layer.feature.properties);
}

function resetHighlight(e) {
    geojson.resetStyle(e.target);
    info.update();
}

// function onEachFeature(feature, layer) {
//     layer.on({
//         mouseover: highlightFeature,
//         mouseout: resetHighlight
//     });
// }

  
    // Create a map instance and set the initial view coordinates and zoom level
    var map = L.map('map', {
        center: [0,0],
        dragging: true,
        scrollWheelZoom: "center",
    }).setView(asv_coords, 13);
  
  
    // Add a tile layer to the map from OpenStreetMap
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);
  
  
    // Create a marker with popup and add it to the map
    var marker = L.marker(asv_coords).addTo(map);
    marker.bindPopup("Hello, I'm a marker!").openPopup();

    var geojson;
    geojson = L.geoJson(geojsonData, {
        style: style //,
        //onEachFeature: onEachFeature
    }).addTo(map);

    var info = L.control();

    info.onAdd = function (map) {
        this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
        this.update();
        return this._div;
    };

    // method that we will use to update the control based on feature properties passed
    info.update = function (props) {
        this._div.innerHTML = '<h4>Driving time</h4>' +  (props ?
            '<b> \<' + (props.value)/60 + ' minutes </b> <br> <b> Zone ' + props.zone + '=> Â£' + props.zone * 1 +' </b>'
            : '<b> \< 15 minutes </b>');
    };

    info.addTo(map);

    //Attempt a crosshair

    // Add in a crosshair for the map
var crosshairIcon = L.icon({
    iconUrl: "target-large.png",
    interactive: false,
    iconSize:     [30, 30], // size of the icon
    iconAnchor:   [10, 10], // point of the icon which will correspond to marker's location
});
crosshair = new L.marker(map.getCenter(), {icon: crosshairIcon, interactive:false});
crosshair.addTo(map);

// Move the crosshair to the center of the map when the user pans
map.on('move', function(e) {
    crosshair.setLatLng(map.getCenter());
    geojsonData.features.map( item => { 
        if(isMarkerInsideDonutPolygon(map.getCenter(), item)){
            console.log(item)
            info.update(item.properties)

    } })
    //console.log(e)
});


  });